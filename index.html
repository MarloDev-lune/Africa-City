<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Africa City</title>
</head>
<body>

  <!-- حقل إدخال الإيميل -->
  <input type="email" id="user-email" placeholder="Enter your email" required>
  
  <!-- زر لإرسال الرمز -->
  <button onclick="sendCode()">Send Verification Code</button>

  <!-- حقل إدخال الرمز (يتم إخفاؤه حتى يتم إرسال الرمز) -->
  <div id="code-container" style="display: none;">
    <input type="text" id="verification-code" placeholder="Enter the code" required>
    <button onclick="verifyCode()">Verify Code</button>
  </div>

  <script type="module">
    // استيراد مكتبة EmailJS الحديثة
    import emailjs from 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js';

    // Initialize EmailJS مع Public Key الخاص بك
    emailjs.init("pDB0RvlQN49S0PH-L");

    // دالة لإرسال الرمز إلى الإيميل
    function sendCode() {
      const email = document.getElementById("user-email").value.trim();  // الحصول على الإيميل من الحقل

      if (!email) {
        alert("يرجى إدخال بريدك الإلكتروني.");
        return;
      }

      const code = Math.floor(1000 + Math.random() * 9000); // توليد كود عشوائي مكون من 4 أرقام

      // إرسال الرمز عبر EmailJS
      emailjs.send("service_tid0byc", "template_cfx1qfk", {
        to_email: email,   // الإيميل الذي سيتم إرسال الرمز إليه
        code: code,        // الرمز العشوائي المولد
        email: email       // الإيميل الخاص بالمستخدم
      }).then(function(response) {
        alert("✅ تم إرسال الرمز إلى بريدك الإلكتروني!");
        console.log("SUCCESS", response.status, response.text);

        // إظهار حقل إدخال الرمز بعد إرسال الرمز
        document.getElementById("code-container").style.display = "block";
      }, function(error) {
        alert("❌ فشل في إرسال الرمز. حاول مرة أخرى.");
        console.error("FAILED", error);
      });
    }

    // دالة للتحقق من الرمز
    function verifyCode() {
      const enteredCode = document.getElementById("verification-code").value.trim();  // الحصول على الرمز المدخل
      const correctCode = document.querySelector("#code-container").dataset.code;  // الرمز المرسل

      if (enteredCode === correctCode) {
        alert("✅ تم التحقق من الرمز بنجاح!");
        window.location.href = "your-next-page.html";  // الانتقال إلى الصفحة التالية
      } else {
        alert("❌ الرمز غير صحيح. حاول مرة أخرى.");
      }
    }
  </script>

</body>
</html>

